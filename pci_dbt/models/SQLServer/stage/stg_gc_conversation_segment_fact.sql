{{ config(materialized='ephemeral') }}

SELECT 
	   gcsf.ID
      ,gcsf.CONVERSATION_ID
      ,gcsf.DIVISION_ID
      ,gcsf.CREATE_AUDIT_KEY
      ,gcsf.UPDATE_AUDIT_KEY
      ,gcsf.USER_DATA_KEY_1
      ,gcsf.USER_DATA_KEY_2
      ,gcsf.START_DATE_TIME_KEY
      ,gcsf.END_DATE_TIME_KEY
      ,gcsf.CONVERSATION_START
      ,gcsf.CONVERSATION_END
      ,gcsf.CONVERSATION_START_TS
      ,gcsf.CONVERSATION_END_TS
      ,gcsf.ORIGINATING_DIRECTION
      ,gcsf.SESSION_DIRECTION
      ,gcsf.SESSION_ID
      ,gcsf.PARTICIPANT_ID
      ,gcsf.PARTICIPANT_ORDINAL
      ,gcsf.USER_ID
      ,gcsf.PURPOSE
      ,gcsf.MEDIA_TYPE
      ,gcsf.STATE
      ,gcsf.ANI
      ,gcsf.DNIS
      ,gcsf.SESSION_DNIS
      ,gcsf.EDGE_ID
      ,gcsf.PEER_ID
      ,gcsf.PROTOCOL_CALLID
      ,gcsf.PROVIDER
      ,gcsf.REMOTE
      ,gcsf.RECORDING
      ,gcsf.MIN_CONVERSATION_MOS
      ,gcsf.MIN_CONVERSATION_RFACTOR
      ,gcsf.SELF_SERVED
      ,gcsf.SELECTED_AGENT_ID
      ,gcsf.SELECTED_AGENT_RANK
      ,gcsf.SEGMENT_START
      ,gcsf.SEGMENT_END
      ,gcsf.SEGMENT_START_TS
      ,gcsf.SEGMENT_END_TS
      ,gcsf.QUEUE_ID
      ,gcsf.WRAP_UP_NAME
      ,gcsf.WRAP_UP_CODE
      ,gcsf.WRAP_UP_NOTE
      ,gcsf.DISCONNECT_TYPE
      ,gcsf.REQUESTED_ROUTING_SKILL_IDS
      ,gcsf.CONFERENCE
      ,gcsf.TRANSFERRED_BLIND
      ,gcsf.COBROWSE_SESSIONS
      ,gcsf.CONNECTED
      ,gcsf.CONSULT
      ,gcsf.TRANSFERRED_CONSULT
      ,gcsf.ERROR
      ,gcsf.FLOW
      ,gcsf.FLOW_OUT
      ,gcsf.FLOW_OUTCOME
      ,gcsf.FLOW_OUTCOME_FAILED
      ,gcsf.FLOW_MILESTONE
      ,gcsf.OFFERED
      ,gcsf.OUTBOUND
      ,gcsf.OUTBOUND_ABANDONED
      ,gcsf.OUTBOUND_ATTEMPTED
      ,gcsf.OUTBOUND_CONNECTED
      ,gcsf.OVER_SLA
      ,gcsf.STATE_TRANSITION_ERROR
      ,gcsf.TRANSFERRED
      ,gcsf.ABANDON_TIME
      ,gcsf.ACD_TIME
      ,gcsf.ACW_TIME
      ,gcsf.AGENT_RESPONSE_TIME
      ,gcsf.ALERT_TIME
      ,gcsf.ANSWERED_TIME
      ,gcsf.CALLBACK_TIME
      ,gcsf.CALLBACK_COMPLETE_TIME
      ,gcsf.FIRST_CONNECT_TIME
      ,gcsf.FIRST_DIAL_TIME
      ,gcsf.CONTACTING_TIME
      ,gcsf.DIALING_TIME
      ,gcsf.FLOW_TIME
      ,gcsf.FLOW_EXIT_TIME
      ,gcsf.FLOW_OUTCOME_TIME
      ,gcsf.FLOW_OUT_TIME
      ,gcsf.HANDLE_TIME
      ,gcsf.HELD_TIME
      ,gcsf.HELD_COMPLETE_TIME
      ,gcsf.IVR_TIME
      ,gcsf.MONITORING_TIME
      ,gcsf.NOT_RESPONDING_TIME
      ,gcsf.SHORT_ABANDON_TIME
      ,gcsf.TALK_TIME
      ,gcsf.TALK_COMPLETE_TIME
      ,gcsf.USER_RESPONSE_TIME
      ,gcsf.VOICE_MAIL_TIME
      ,gcsf.WAIT_TIME
      ,gcsf.BARGING_TIME
      ,gcsf.FORM_NAME
      ,gcsf.TOTAL_SCORE
      ,gcsf.EVALUATOR_ID
      ,gcsf.RESCORED
      ,gcsf.FLOW_ID
      ,gcsf.FLOW_NAME
      ,gcsf.FLOW_TYPE
      ,gcsf.FLOW_VERSION
      ,gcsf.ENTRY_TYPE
      ,gcsf.ENTRY_REASON
      ,gcsf.EXIT_REASON
      ,gcsf.STARTING_LANGUAGE
      ,gcsf.ENDING_LANGUAGE
      ,gcsf.TRANSFER_TYPE
      ,gcsf.TRANSFER_TARGET_ADDRESS
      ,gcsf.TRANSFER_TARGET_NAME
      ,gcsf.FLOW_IN_TYPE
      ,gcsf.FLOW_OUT_TYPE
      ,gcsf.RECOGNITION_FAILURE_REASON
      ,gcsf.ISSUED_CALLBACK
      ,gcsf.EXTERNAL_TAG
      ,gcsf.GROUP_ID
      ,gcsf.EXTERNAL_CONTACT_ID
      ,gcsf.OUTBOUND_CAMPAIGN_ID
      ,gcsf.OUTBOUND_CONTACT_ID
      ,gcsf.OUTBOUND_CONTACT_LIST_ID
      ,gcsf.DISPOSITION_ANALYZER
      ,gcsf.DISPOSITION_NAME
      ,gcsf.DELIVERY_STATUS
      ,gcsf.DELIVERY_STATUS_CHANGE_DATE
      ,gcsf.EXTENDED_DELIVERY_STATUS
      ,gcsf.DESTINATION_ADDRESSES
      ,gcsf.ADDRESS_FROM
      ,gcsf.ADDRESS_TO
      ,gcsf.CALLBACK_USER_NAME
      ,gcsf.CALLBACK_NUMBERS
      ,gcsf.CALLBACK_SCHEDULED_TIME
      ,gcsf.CONVERSATION_INITIATOR
      ,gcsf.REQUESTED_LANGUAGE_ID
      ,gcsf.ACTIVE_SKILLIDS
      ,gcsf.AGENT_BULLSEYE_RING
      ,gcsf.ROUTING_RULE
      ,gcsf.ROUTING_RULE_TYPE
      ,gcsf.ROUTING_RING
      ,gcsf.REQUESTED_ROUTINGS
      ,gcsf.USED_ROUTING
      ,gcsf.TRACKING_HASH
      ,gcsf.LAST_MODIFIED
      ,gcsf.ZLOADDATE 
		/*a3.LABEL_TZ AS offset_start,
		a3.LABEL_HH24, 
		a3.LABEL_30MI,
		a4.LABEL_TZ AS offset_end,	*/
	   ,NULL offset_start,
		NULL offset_end,
		NULL label_hh24,
		NULL label_30mi,
		CASE WHEN CALLBACK_NUMBERS LIKE '%#379%' THEN 1 
		     ELSE 0 END AS cvs_LocalizedFlag,
		CASE
		WHEN OUTBOUND_CONTACT_ID ='e9a5ac25c17999eb8fee08a0cb2072f2' THEN 20285341
		WHEN OUTBOUND_CONTACT_ID ='09fdb9c74b90ff4c3e6600de5a18f57b' THEN 20294043
		WHEN OUTBOUND_CONTACT_ID ='8660c94c1938076a5c2f4f3aee3fbf41' THEN 20300570
		WHEN OUTBOUND_CONTACT_ID ='10e7776c9757e1dd44e72196b1955a3f' THEN 20286100
		WHEN OUTBOUND_CONTACT_ID ='4bafc0d2508a09e62269a4db03809fd1' THEN 20296444
		WHEN OUTBOUND_CONTACT_ID ='100efd00abedf99a8dc7ced3582542bd' THEN 20298053
		WHEN OUTBOUND_CONTACT_ID ='93d8977385cd271378fcc9e22a05ad8a' THEN 20296475
		WHEN OUTBOUND_CONTACT_ID ='1a8b109160b7d1f7d4cde586ab14c26c' THEN 20300615
		WHEN OUTBOUND_CONTACT_ID ='e963bb8be50a20a1b4f4dc23e91f8642' THEN 20300565
		WHEN OUTBOUND_CONTACT_ID ='1649841d2b63a878161f843245fcbdc3' THEN 20285027
		WHEN OUTBOUND_CONTACT_ID ='d1cd8e711f79b908f0f7617225710408' THEN 20293769
		WHEN OUTBOUND_CONTACT_ID ='0c4e35b78f81a5810dc9d7047f5830bf' THEN 20300581
		WHEN OUTBOUND_CONTACT_ID ='2ba80c77d1a7680cff2a6fe87837b28a' THEN 20288568
		WHEN OUTBOUND_CONTACT_ID ='17afcd7474fbf261ce8a086866acd69a' THEN 20285260
		WHEN OUTBOUND_CONTACT_ID ='d9010b25d51e94e170646e0c4e718134' THEN 20300568
		WHEN OUTBOUND_CONTACT_ID ='e8d7c03dc645a65422c4d54601f29356' THEN 20296624
		WHEN OUTBOUND_CONTACT_ID ='09f2deb5e8d4244628002cba48c2e370' THEN 20300588
		WHEN OUTBOUND_CONTACT_ID ='c4ae2d5da72f18c47c609882dae71de1' THEN 20285221
		WHEN OUTBOUND_CONTACT_ID ='752edc82b2cf1882a352ac87e8a45147' THEN 20300623
		WHEN OUTBOUND_CONTACT_ID ='3ac79b7b9583cda2ab421e169b296ba6' THEN 20300594
		WHEN OUTBOUND_CONTACT_ID ='abc18e2178f9c75919cf327333361dc0' THEN 20285113
		WHEN OUTBOUND_CONTACT_ID ='767ab9645f7b91366ade7372a829d862' THEN 20300608
		WHEN OUTBOUND_CONTACT_ID ='c41361cbcca2324df3a4517302f02e3b' THEN 20300624
		WHEN OUTBOUND_CONTACT_ID ='6b7e1b63950499928848fe9078d1ae67' THEN 20289195
		WHEN OUTBOUND_CONTACT_ID ='6b7e1b63950499928848fe9078d1ae67' THEN 20289195
		WHEN OUTBOUND_CONTACT_ID ='7b116dc878f743508dd44b4c92712898' THEN 20292694
		WHEN OUTBOUND_CONTACT_ID ='dd22cac7f01c2dff355db84fbe8fac65' THEN 20292510
		WHEN OUTBOUND_CONTACT_ID ='5eab9b096f28b14bc08ae14950a6c541' THEN 20291217
		WHEN OUTBOUND_CONTACT_ID ='0a45c33fcdba08b3c7ed71ecd4566670' THEN 20284819
		WHEN OUTBOUND_CONTACT_ID ='c5b9b49d06b990af1462ea9fd1688987' THEN 20288796
		WHEN OUTBOUND_CONTACT_ID ='5d40f5175135e680ae034a69752cec10' THEN 20300625
		WHEN OUTBOUND_CONTACT_ID ='e3236583a4f8d1b2ade5d79472510065' THEN 20286194
		WHEN OUTBOUND_CONTACT_ID ='b931c46c1b5359bcdad0efdf30d016b5' THEN 20300515
		WHEN OUTBOUND_CONTACT_ID ='5d3f86e68ee663fee82746b141fb2b11' THEN 20296532
		WHEN OUTBOUND_CONTACT_ID ='d6a442b50f30231e771203cd18d044ae' THEN 20300627
		WHEN OUTBOUND_CONTACT_ID ='be24e9371fa67df4f3003c378f50e0d9' THEN 20300538
		WHEN OUTBOUND_CONTACT_ID ='be24e9371fa67df4f3003c378f50e0d9' THEN 20300538
		WHEN OUTBOUND_CONTACT_ID ='3e0ddac07fe1d2f32c23f20cc10c2996' THEN 20300620
		WHEN OUTBOUND_CONTACT_ID ='5610b7c9f0b1c92e30baf463b28f2c9e' THEN 20288143
		WHEN OUTBOUND_CONTACT_ID ='846905ba7fc0b734b603b28f7bf45d9c' THEN 20298069
		WHEN OUTBOUND_CONTACT_ID ='c8fcbb6e7b996e77d97b45e423fb1e6f' THEN 20300637
		WHEN OUTBOUND_CONTACT_ID ='1a7bc260cffe88f6674d3b927e80c179' THEN 20300622
		WHEN OUTBOUND_CONTACT_ID ='1a7bc260cffe88f6674d3b927e80c179' THEN 20300622
		WHEN OUTBOUND_CONTACT_ID ='82e278a7975bc74ad15b55a50560e544' THEN 20298041
		WHEN OUTBOUND_CONTACT_ID ='6fc7a126d0ea730a3e8aa17132e4cd01' THEN 20288498
		WHEN OUTBOUND_CONTACT_ID ='6fc7a126d0ea730a3e8aa17132e4cd01' THEN 20288498
		WHEN OUTBOUND_CONTACT_ID ='064420f9ef5a17beb467287341a37264' THEN 20293458
		WHEN OUTBOUND_CONTACT_ID ='6d90f3b464314e3841c7f2b87332615b' THEN 20300616
		WHEN OUTBOUND_CONTACT_ID ='11ae9d0f390d50fe77840728e30551f7' THEN 20300650
		WHEN OUTBOUND_CONTACT_ID ='11ae9d0f390d50fe77840728e30551f7' THEN 20300650
		WHEN OUTBOUND_CONTACT_ID ='28b42d0045e4f7c04402df470e33edec' THEN 20300574
		WHEN OUTBOUND_CONTACT_ID ='a183b9822d9b889e8d0a38d4d4380cc9' THEN 20298048
		WHEN OUTBOUND_CONTACT_ID ='20e0d2c7e5527892a099878c70eb7db3' THEN 20300603
		WHEN OUTBOUND_CONTACT_ID ='ef7b00187874ea224d6caeba3d06c560' THEN 20299704
		WHEN OUTBOUND_CONTACT_ID ='4193dfa0865c0ec33314f8cdef74f0d5' THEN 20288303
		WHEN OUTBOUND_CONTACT_ID ='0fd041ba79b4e8d20301181f664a8ad5' THEN 20300613
		WHEN OUTBOUND_CONTACT_ID ='327e7dea8e38690f499e28c917f2e923' THEN 20300645
		WHEN OUTBOUND_CONTACT_ID ='327e7dea8e38690f499e28c917f2e923' THEN 20300645
		WHEN OUTBOUND_CONTACT_ID ='d7f63380bedeec385d0e756ba77355ef' THEN 20300614
		WHEN OUTBOUND_CONTACT_ID ='d7f63380bedeec385d0e756ba77355ef' THEN 20300614
		WHEN OUTBOUND_CONTACT_ID ='a61d3cd40c95045881c5d6fdee483cd5' THEN 20285047
		WHEN OUTBOUND_CONTACT_ID ='a61d3cd40c95045881c5d6fdee483cd5' THEN 20285047
		WHEN OUTBOUND_CONTACT_ID ='32ae6450225f1585982bee32eda38b14' THEN 20291268
		WHEN OUTBOUND_CONTACT_ID ='ae848afc364c46c1fda98819a8c8c116' THEN 20300498
		WHEN OUTBOUND_CONTACT_ID ='fdd5fb9f6bcd64ce56a39374e07f093b' THEN 20300635
		WHEN OUTBOUND_CONTACT_ID ='4f8c8f264d6dd21f85bae2034b1964c8' THEN 20286521
		WHEN OUTBOUND_CONTACT_ID ='39517d80b1adc465466b44223414e7c3' THEN 20300647
		WHEN OUTBOUND_CONTACT_ID ='02ba05213eca485041875b1f5972488a' THEN 20300673
		WHEN OUTBOUND_CONTACT_ID ='adb551d4079d901f65e035af64e68218' THEN 20290497
		WHEN OUTBOUND_CONTACT_ID ='e58a9e39492a372ec841f12d08447667' THEN 20296617
		WHEN OUTBOUND_CONTACT_ID ='6d3954b4d66a3427af495c367f1868a7' THEN 20296695
		WHEN OUTBOUND_CONTACT_ID ='17b2355e7f8c6f794dc6eb47b3bb12e5' THEN 20300677
		WHEN OUTBOUND_CONTACT_ID ='9cc5858f6b75ec4901550bfd768bb7eb' THEN 20284603
		WHEN OUTBOUND_CONTACT_ID ='f3e155ea4b6f84aaa2fc54d9f925d275' THEN 20285811
		WHEN OUTBOUND_CONTACT_ID ='a8da3a94f1a5c440443bb0a9056e60bd' THEN 20288421
		WHEN OUTBOUND_CONTACT_ID ='a8da3a94f1a5c440443bb0a9056e60bd' THEN 20288421
		WHEN OUTBOUND_CONTACT_ID ='de6e60921ac30ce1e819c526f7b0e8cc' THEN 20300658
		WHEN OUTBOUND_CONTACT_ID ='d75af1639d7c246f2c3b3752b42fa7ea' THEN 20293566
		WHEN OUTBOUND_CONTACT_ID ='42d44c75796c3bb53f7a87681b92f4c7' THEN 20300678
		WHEN OUTBOUND_CONTACT_ID ='5b4d37de835ca9951431aacd75295af9' THEN 20286855
		WHEN OUTBOUND_CONTACT_ID ='e1f604f433aea07d1e41433659a5ede6' THEN 20300567
		WHEN OUTBOUND_CONTACT_ID ='8333ae8495a2b31c438b5b78e8c7a50e' THEN 20293709
		WHEN OUTBOUND_CONTACT_ID ='e5215e58b96495310b27f6bd23d0068b' THEN 20300630
		WHEN OUTBOUND_CONTACT_ID ='c30c1ff2aeb3ca13a43d724d294753af' THEN 20289264
		WHEN OUTBOUND_CONTACT_ID ='2259526994c015165f568bffd50af6c1' THEN 20286440
		WHEN OUTBOUND_CONTACT_ID ='3f8725ad5d1454ffc7209abc0b28fb28' THEN 20300572
		WHEN OUTBOUND_CONTACT_ID ='3f8725ad5d1454ffc7209abc0b28fb28' THEN 20300572
		WHEN OUTBOUND_CONTACT_ID ='63b1592db34512bf9af91d4728b7c30c' THEN 20300586
		WHEN OUTBOUND_CONTACT_ID ='51b15dd1a9f76a622d964a1d9e5178d9' THEN 20296574
		WHEN OUTBOUND_CONTACT_ID ='51b15dd1a9f76a622d964a1d9e5178d9' THEN 20296574
		WHEN OUTBOUND_CONTACT_ID ='52e27eaecac342a2ca5270eeafcf0638' THEN 20286227
		WHEN OUTBOUND_CONTACT_ID ='2de72c2f1159bc8c37e27fac56ce6f36' THEN 20298867
		WHEN OUTBOUND_CONTACT_ID ='1372acae5e4934f54f5178fe82ef71d2' THEN 20288999
		WHEN OUTBOUND_CONTACT_ID ='cdbe62bffdabab73b3d7a7a79b19a718' THEN 20300661
		WHEN OUTBOUND_CONTACT_ID ='d4dc6c5d81ebb690d1542ed844328779' THEN 20300577
		WHEN OUTBOUND_CONTACT_ID ='fd52796140aeed501d7777255f4d0183' THEN 20300597
		WHEN OUTBOUND_CONTACT_ID ='27a4f702754974582603c517036f0ab3' THEN 20296432
		WHEN OUTBOUND_CONTACT_ID ='27a4f702754974582603c517036f0ab3' THEN 20296432
		WHEN OUTBOUND_CONTACT_ID ='800b2149a441dcebd8f66f90375e4133' THEN 20288953
		WHEN OUTBOUND_CONTACT_ID ='800b2149a441dcebd8f66f90375e4133' THEN 20288953
		WHEN OUTBOUND_CONTACT_ID ='c70fad51c3a1731dc9247754b6693c5d' THEN 20293612
		WHEN OUTBOUND_CONTACT_ID ='6874c2290ffa75e43b7e95b4083fafb6' THEN 20292739
		WHEN OUTBOUND_CONTACT_ID ='60072803a5f294d4ba4f23e3af357372' THEN 20298067
		WHEN OUTBOUND_CONTACT_ID ='0fc11d79cd7a51b1319bb11eae1a69c4' THEN 20299221
		WHEN OUTBOUND_CONTACT_ID ='71d1a562f55539712dfa0b89e2832871' THEN 20291487
		WHEN OUTBOUND_CONTACT_ID ='71d1a562f55539712dfa0b89e2832871' THEN 20291487
		WHEN OUTBOUND_CONTACT_ID ='b3a8df80e673cdfd66ecc3c494b3f303' THEN 20292760
		WHEN OUTBOUND_CONTACT_ID ='da1c5cbe3a9fd511494cbe3a4807adb7' THEN 20291915
		WHEN OUTBOUND_CONTACT_ID ='d575f01225c39b2af716ae93ea4dd363' THEN 20290863
		WHEN OUTBOUND_CONTACT_ID ='dc52a6bdb162444119d7e5db37b95152' THEN 20298025
		WHEN OUTBOUND_CONTACT_ID ='2973efe02f85af9d90486dcbcce654ff' THEN 20291199
		WHEN OUTBOUND_CONTACT_ID ='2973efe02f85af9d90486dcbcce654ff' THEN 20291199
		WHEN OUTBOUND_CONTACT_ID ='8784f4ad4c6e3c3c706e918fe4e353a2' THEN 20300593
		WHEN OUTBOUND_CONTACT_ID ='45e194cdab714819ba5ef757a80fcc05' THEN 20299214
		WHEN OUTBOUND_CONTACT_ID ='4a7fb852c8823ab09d7eda47ba15c9e4' THEN 20300587
		WHEN OUTBOUND_CONTACT_ID ='f0b67eac722006c6108472704bb70605' THEN 20300575
		WHEN OUTBOUND_CONTACT_ID ='2340342c7cacbcfbaba36e5f36bd2461' THEN 20300640
		WHEN OUTBOUND_CONTACT_ID ='2340342c7cacbcfbaba36e5f36bd2461' THEN 20300640
		WHEN OUTBOUND_CONTACT_ID ='f9533a2dca1120efd6b6fb87d8c2ec46' THEN 20296439
		WHEN OUTBOUND_CONTACT_ID ='4087b6c67fdb29a5d2a92eca6f86de0f' THEN 20300618
		WHEN OUTBOUND_CONTACT_ID ='faa5345b251baa9efe2bae789d4a1adc' THEN 20286832
		ELSE NULL END AS OUTBOUND_CONTACT_ID_OVERRIDE
	FROM {{ source('dbinterface', 'gc_CONVERSATIONS_SEGMENT_FACT')  }} gcsf 
	INNER JOIN ( SELECT DISTINCT CONVERSATION_ID FROM {{ source('dbinterface', 'gc_CONVERSATIONS_SEGMENT_FACT') }} gcsf
				  WHERE gcsf.LAST_MODIFIED >= {{ var("end_date", "2025-04-20") }} ) gcsf1 ON gcsf.CONVERSATION_ID = gcsf1.CONVERSATION_ID
